<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>Simple VLESS Test</title>
    <style>
        body { padding: 20px; font-family: Arial; background: #f0f0f0; }
        .container { max-width: 600px; margin: 0 auto; background: white; padding: 20px; border-radius: 10px; }
        button { background: #007bff; color: white; border: none; padding: 15px 30px; border-radius: 5px; font-size: 18px; cursor: pointer; margin: 10px 0; }
        button:hover { background: #0056b3; }
        .result { padding: 15px; margin: 10px 0; border-radius: 5px; font-weight: bold; }
        .success { background: #d4edda; color: #155724; }
        .error { background: #f8d7da; color: #721c24; }
        .info { background: #d1ecf1; color: #0c5460; }
    </style>
</head>
<body>
    <div class="container">
        <h1>üõ°Ô∏è –ü—Ä–æ—Å—Ç–æ–π —Ç–µ—Å—Ç VLESS</h1>
        <p>–≠—Ç–æ—Ç —Ç–µ—Å—Ç –ø—Ä–æ–≤–µ—Ä—è–µ—Ç <strong>–¢–û–ß–ù–û –¢–û –ñ–ï</strong>, —á—Ç–æ –¥–µ–ª–∞–µ—Ç –æ—Å–Ω–æ–≤–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ</p>
        
        <button onclick="testVLESS()">üß™ –¢–µ—Å—Ç VLESS –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è</button>
        
        <div id="result" class="result info">–ù–∞–∂–º–∏—Ç–µ –∫–Ω–æ–ø–∫—É –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è</div>
        
        <div id="details"></div>
    </div>

    <script src="vless-protocol.js"></script>
    <script>
        async function testVLESS() {
            const resultDiv = document.getElementById('result');
            const detailsDiv = document.getElementById('details');
            
            resultDiv.textContent = 'üîÑ –¢–µ—Å—Ç–∏—Ä—É–µ–º VLESS –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ...';
            resultDiv.className = 'result info';
            detailsDiv.innerHTML = '';
            
            try {
                // –¢–æ—á–Ω–æ —Ç–∞–∫–æ–π –∂–µ –∫–æ–¥, –∫–∞–∫ –≤ –æ—Å–Ω–æ–≤–Ω–æ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏
                const webrtcVless = new WebRTCOverVLESS();
                
                const details = [];
                
                webrtcVless.onConnectionChange = (state) => {
                    details.push(`üîÑ –°–æ—Å—Ç–æ—è–Ω–∏–µ: ${state}`);
                    detailsDiv.innerHTML = details.join('<br>');
                    
                    if (state === 'connected') {
                        resultDiv.textContent = '‚úÖ VLESS –†–ê–ë–û–¢–ê–ï–¢! –ú–æ–∂–Ω–æ –Ω–∞—á–∏–Ω–∞—Ç—å –∑–≤–æ–Ω–æ–∫';
                        resultDiv.className = 'result success';
                        
                        details.push('üéâ –£–°–ü–ï–•: VLESS —Ç—É–Ω–Ω–µ–ª—å —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω!');
                        details.push('üìû –¢–µ–ø–µ—Ä—å –º–æ–∂–Ω–æ –¥–µ–ª–∞—Ç—å –∑–∞—â–∏—â–µ–Ω–Ω—ã–µ –∑–≤–æ–Ω–∫–∏');
                        detailsDiv.innerHTML = details.join('<br>');
                        
                    } else if (state === 'error' || state === 'disconnected') {
                        resultDiv.textContent = '‚ùå –û–®–ò–ë–ö–ê VLESS –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è';
                        resultDiv.className = 'result error';
                        
                        details.push('‚ùå –û–®–ò–ë–ö–ê: VLESS –Ω–µ –ø–æ–¥–∫–ª—é—á–∏–ª—Å—è');
                        details.push('üîß –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ —Å–µ—Ä–≤–µ—Ä–∞');
                        detailsDiv.innerHTML = details.join('<br>');
                    }
                };
                
                details.push('üöÄ –ù–∞—á–∏–Ω–∞–µ–º –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—é VLESS...');
                detailsDiv.innerHTML = details.join('<br>');
                
                await webrtcVless.initVLESS();
                
                const status = webrtcVless.getStatus();
                details.push(`üìä –°—Ç–∞—Ç—É—Å: VLESS –ø–æ–¥–∫–ª—é—á–µ–Ω = ${status.vlessConnected}`);
                detailsDiv.innerHTML = details.join('<br>');
                
            } catch (error) {
                resultDiv.textContent = `‚ùå –û–®–ò–ë–ö–ê: ${error.message}`;
                resultDiv.className = 'result error';
                
                const details = [
                    '‚ùå –ü—Ä–æ–∏–∑–æ—à–ª–∞ –æ—à–∏–±–∫–∞ –ø—Ä–∏ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–∏ –∫ VLESS',
                    `üîß –î–µ—Ç–∞–ª–∏ –æ—à–∏–±–∫–∏: ${error.message}`,
                    'üí° –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –æ–±–Ω–æ–≤–∏—Ç—å —Å—Ç—Ä–∞–Ω–∏—Ü—É (Ctrl+F5)'
                ];
                detailsDiv.innerHTML = details.join('<br>');
            }
        }
    </script>
</body>
</html>