<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üöÄ CosmosChat - –ö–æ—Å–º–∏—á–µ—Å–∫–∏–π –º–µ—Å—Å–µ–Ω–¥–∂–µ—Ä</title>
    <link rel="stylesheet" href="styles.css">
    <link rel="stylesheet" href="animations.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>
<body>
    <!-- –ö–æ—Å–º–∏—á–µ—Å–∫–∏–π —Ñ–æ–Ω —Å —á–∞—Å—Ç–∏—Ü–∞–º–∏ -->
    <div class="cosmic-background">
        <canvas id="starsCanvas"></canvas>
        <div class="particles"></div>
    </div>

    <!-- –≠–∫—Ä–∞–Ω –∑–∞–≥—Ä—É–∑–∫–∏ -->
    <div class="loading-screen" id="loadingScreen">
        <div class="logo-container">
            <div class="cosmic-logo">
                <div class="planet"></div>
                <div class="orbit">
                    <div class="satellite"></div>
                </div>
                <div class="stars-around">
                    <div class="star"></div>
                    <div class="star"></div>
                    <div class="star"></div>
                    <div class="star"></div>
                    <div class="star"></div>
                </div>
            </div>
            <h1 class="app-title glow">CosmosChat</h1>
            <p class="tagline">–°–≤—è–∑—å –±–µ–∑ –≥—Ä–∞–Ω–∏—Ü –≤–æ –≤—Å–µ–ª–µ–Ω–Ω–æ–π –æ–±—â–µ–Ω–∏—è</p>
        </div>
        <div class="loading-bar">
            <div class="loading-progress"></div>
        </div>
    </div>

    <!-- –≠–∫—Ä–∞–Ω –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ -->
    <div class="auth-screen hidden" id="authScreen">
        <div class="auth-container">
            <div class="auth-header">
                <div class="cosmic-logo small">
                    <div class="planet small"></div>
                    <div class="orbit">
                        <div class="satellite"></div>
                    </div>
                </div>
                <h1 class="glow">–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å!</h1>
                <p>–í–æ–π–¥–∏—Ç–µ –≤ –∫–æ—Å–º–æ—Å –±–µ–∑–≥—Ä–∞–Ω–∏—á–Ω–æ–≥–æ –æ–±—â–µ–Ω–∏—è</p>
            </div>

            <!-- –§–æ—Ä–º–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ -->
            <div class="auth-form" id="registrationForm">
                <div class="form-group floating-label">
                    <input type="text" id="userName" class="cosmic-input" required>
                    <label for="userName">üë§ –í–∞—à–µ –∏–º—è</label>
                    <div class="input-glow"></div>
                </div>
                
                <div class="form-group floating-label">
                    <input type="tel" id="userPhone" class="cosmic-input" required>
                    <label for="userPhone">üì± –ù–æ–º–µ—Ä —Ç–µ–ª–µ—Ñ–æ–Ω–∞</label>
                    <div class="input-glow"></div>
                </div>

                <button class="cosmic-button primary pulse" id="registerBtn">
                    <span class="button-bg"></span>
                    <span class="button-text">üöÄ –ó–∞–ø—É—Å—Ç–∏—Ç—å –≤ –∫–æ—Å–º–æ—Å!</span>
                    <div class="button-particles"></div>
                </button>

                <div class="auth-footer">
                    <p>–£–∂–µ –µ—Å—Ç—å –∞–∫–∫–∞—É–Ω—Ç? <a href="#" class="glow-link switch-to-login">–í–æ–π—Ç–∏</a></p>
                </div>
            </div>

            <!-- –§–æ—Ä–º–∞ –≤—Ö–æ–¥–∞ -->
            <div class="auth-form hidden" id="loginForm">
                <div class="form-group floating-label">
                    <input type="tel" id="loginPhone" class="cosmic-input" required>
                    <label for="loginPhone">üì± –ù–æ–º–µ—Ä —Ç–µ–ª–µ—Ñ–æ–Ω–∞</label>
                    <div class="input-glow"></div>
                </div>

                <button class="cosmic-button primary pulse" id="loginBtn">
                    <span class="button-bg"></span>
                    <span class="button-text">üåü –í–æ–π—Ç–∏ –≤ –∫–æ—Å–º–æ—Å</span>
                    <div class="button-particles"></div>
                </button>

                <div class="auth-footer">
                    <p>–ù–µ—Ç –∞–∫–∫–∞—É–Ω—Ç–∞? <a href="#" class="glow-link switch-to-register">–°–æ–∑–¥–∞—Ç—å</a></p>
                </div>
            </div>

            <!-- –†–∞–∑—Ä–µ—à–µ–Ω–∏—è -->
            <div class="permissions-screen hidden" id="permissionsScreen">
                <div class="permissions-header">
                    <div class="permission-icon">üé•</div>
                    <h2 class="glow">–ö–æ—Å–º–∏—á–µ—Å–∫–∏–µ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è</h2>
                    <p>–î–ª—è –ø–æ–ª–Ω–æ—Ü–µ–Ω–Ω–æ–≥–æ –æ–±—â–µ–Ω–∏—è –Ω—É–∂–Ω—ã —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è:</p>
                </div>

                <div class="permissions-list">
                    <div class="permission-item">
                        <div class="permission-icon-small">üìπ</div>
                        <div class="permission-text">
                            <h4>–ö–∞–º–µ—Ä–∞</h4>
                            <p>–î–ª—è –≤–∏–¥–µ–æ–∑–≤–æ–Ω–∫–æ–≤ –∏ —Å–µ–ª—Ñ–∏</p>
                        </div>
                        <div class="permission-status" id="cameraStatus">‚è≥</div>
                    </div>
                    
                    <div class="permission-item">
                        <div class="permission-icon-small">üé§</div>
                        <div class="permission-text">
                            <h4>–ú–∏–∫—Ä–æ—Ñ–æ–Ω</h4>
                            <p>–î–ª—è –≥–æ–ª–æ—Å–æ–≤—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π –∏ –∑–≤–æ–Ω–∫–æ–≤</p>
                        </div>
                        <div class="permission-status" id="micStatus">‚è≥</div>
                    </div>
                </div>

                <button class="cosmic-button primary pulse" onclick="requestPermissions()">
                    <span class="button-bg"></span>
                    <span class="button-text">‚ú® –ü—Ä–µ–¥–æ—Å—Ç–∞–≤–∏—Ç—å —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è</span>
                    <div class="button-particles"></div>
                </button>
            </div>
        </div>
    </div>

    <!-- –û—Å–Ω–æ–≤–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ -->
    <div class="app-container hidden" id="appContainer">
        <!-- –ë–æ–∫–æ–≤–∞—è –ø–∞–Ω–µ–ª—å -->
        <div class="sidebar">
            <div class="sidebar-header">
                <div class="user-profile" onclick="showProfile()">
                    <div class="user-avatar" id="userAvatar">
                        <div class="avatar-glow"></div>
                        <span id="userInitials">–ö–ß</span>
                    </div>
                    <div class="user-info">
                        <h3 id="displayName">–ö–æ—Å–º–∏—á–µ—Å–∫–∏–π —á–∞—Ç</h3>
                        <p class="status online" id="userStatus">–í —Å–µ—Ç–∏</p>
                    </div>
                </div>
                
                <div class="sidebar-controls">
                    <button class="icon-button" onclick="openUserSearch()" title="–ù–∞–π—Ç–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è">
                        <i class="fas fa-user-plus"></i>
                        <div class="button-glow"></div>
                    </button>
                    <button class="icon-button" onclick="startVideoCall()" title="–í–∏–¥–µ–æ–∑–≤–æ–Ω–æ–∫">
                        <i class="fas fa-video"></i>
                        <div class="button-glow"></div>
                    </button>
                </div>
            </div>

            <div class="search-container">
                <div class="search-input-wrapper">
                    <i class="fas fa-search"></i>
                    <input type="text" class="search-input" placeholder="–ü–æ–∏—Å–∫ –≤ –≥–∞–ª–∞–∫—Ç–∏–∫–µ..." id="searchInput" oninput="searchChats()">
                    <div class="search-glow"></div>
                </div>
            </div>

            <div class="chat-categories">
                <div class="category active" data-category="all" onclick="filterChats('all')">
                    <i class="fas fa-comments"></i>
                    <span>–í—Å–µ —á–∞—Ç—ã</span>
                    <div class="category-glow"></div>
                </div>
                <div class="category" data-category="personal" onclick="filterChats('personal')">
                    <i class="fas fa-user"></i>
                    <span>–õ–∏—á–Ω—ã–µ</span>
                    <div class="category-glow"></div>
                </div>
                <div class="category" data-category="groups" onclick="filterChats('groups')">
                    <i class="fas fa-users"></i>
                    <span>–ì—Ä—É–ø–ø—ã</span>
                    <div class="category-glow"></div>
                </div>
                <div class="category" data-category="video" onclick="filterChats('video')">
                    <i class="fas fa-video"></i>
                    <span>–í–∏–¥–µ–æ—á–∞—Ç—ã</span>
                    <div class="category-glow"></div>
                </div>
            </div>

            <div class="chats-list" id="chatsList">
                <!-- –ß–∞—Ç—ã –±—É–¥—É—Ç –¥–æ–±–∞–≤–ª–µ–Ω—ã –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ -->
            </div>
        </div>

        <!-- –û—Å–Ω–æ–≤–Ω–∞—è –æ–±–ª–∞—Å—Ç—å —á–∞—Ç–∞ -->
        <div class="chat-area">
            <div class="chat-header" id="chatHeader">
                <div class="chat-user-info">
                    <div class="chat-avatar">
                        <div class="avatar-glow"></div>
                        <span>–ö–ß</span>
                    </div>
                    <div class="chat-user-details">
                        <h3 id="chatTitle">–í—ã–±–µ—Ä–∏—Ç–µ —á–∞—Ç</h3>
                        <p class="chat-status" id="chatStatus">–¥–ª—è –Ω–∞—á–∞–ª–∞ –æ–±—â–µ–Ω–∏—è</p>
                    </div>
                </div>
                
                <div class="chat-controls">
                    <button class="icon-button" onclick="searchInChat()" title="–ü–æ–∏—Å–∫ –≤ —á–∞—Ç–µ">
                        <i class="fas fa-search"></i>
                    </button>
                    <button class="icon-button" onclick="startVoiceCall()" title="–ì–æ–ª–æ—Å–æ–≤–æ–π –∑–≤–æ–Ω–æ–∫">
                        <i class="fas fa-phone"></i>
                    </button>
                    <button class="icon-button" onclick="startVideoCall()" title="–í–∏–¥–µ–æ–∑–≤–æ–Ω–æ–∫">
                        <i class="fas fa-video"></i>
                    </button>
                    <button class="icon-button" onclick="showChatMenu()" title="–ú–µ–Ω—é">
                        <i class="fas fa-ellipsis-v"></i>
                    </button>
                </div>
            </div>

            <div class="messages-container" id="messagesContainer">
                <div class="welcome-screen">
                    <div class="welcome-animation">
                        <div class="floating-icons">
                            <div class="floating-icon">üí´</div>
                            <div class="floating-icon">üöÄ</div>
                            <div class="floating-icon">üåü</div>
                            <div class="floating-icon">üåô</div>
                            <div class="floating-icon">‚≠ê</div>
                        </div>
                    </div>
                    <h2 class="glow">–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –≤ CosmosChat!</h2>
                    <p>–í—ã–±–µ—Ä–∏—Ç–µ —á–∞—Ç –∏–ª–∏ —Å–æ–∑–¥–∞–π—Ç–µ –Ω–æ–≤—ã–π –¥–ª—è –Ω–∞—á–∞–ª–∞ –∫–æ—Å–º–∏—á–µ—Å–∫–æ–≥–æ –æ–±—â–µ–Ω–∏—è</p>
                </div>
            </div>

            <div class="message-input-area" id="messageInputArea" style="display: none;">
                <div class="message-input-container">
                    <button class="attach-button" onclick="showAttachMenu()">
                        <i class="fas fa-paperclip"></i>
                    </button>
                    
                    <div class="message-input-wrapper">
                        <textarea class="message-input" id="messageInput" placeholder="–ù–∞–ø–∏—à–∏—Ç–µ —Å–æ–æ–±—â–µ–Ω–∏–µ..." 
                                rows="1" oninput="autoResize(this)" onkeydown="handleMessageInput(event)"></textarea>
                        <div class="input-glow"></div>
                    </div>
                    
                    <button class="emoji-button" onclick="showEmojiPicker()">
                        <i class="fas fa-smile"></i>
                    </button>
                    
                    <button class="voice-button" onmousedown="startVoiceRecord()" onmouseup="stopVoiceRecord()">
                        <i class="fas fa-microphone"></i>
                    </button>
                    
                    <button class="send-button" onclick="sendMessage()" id="sendButton">
                        <i class="fas fa-paper-plane"></i>
                        <div class="send-glow"></div>
                    </button>
                </div>
            </div>
        </div>

        <!-- –ü—Ä–∞–≤–∞—è –ø–∞–Ω–µ–ª—å -->
        <div class="right-panel" id="rightPanel">
            <div class="panel-header">
                <h3>–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è</h3>
                <button class="close-panel" onclick="closeRightPanel()">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            
            <div class="panel-content" id="panelContent">
                <!-- –ö–æ–Ω—Ç–µ–Ω—Ç –ø–∞–Ω–µ–ª–∏ –±—É–¥–µ—Ç –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–º -->
            </div>
        </div>
    </div>

    <!-- –ú–æ–¥–∞–ª—å–Ω—ã–µ –æ–∫–Ω–∞ -->
    <div class="modal-overlay" id="modalOverlay"></div>
    
    <!-- –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è -->
    <div class="notifications-container" id="notificationsContainer"></div>

    <!-- –í–∏–¥–µ–æ–∑–≤–æ–Ω–æ–∫ -->
    <div class="video-call-overlay hidden" id="videoCallOverlay">
        <div class="video-call-container">
            <div class="video-streams">
                <video id="localVideo" class="local-video" autoplay muted playsinline></video>
                <video id="remoteVideo" class="remote-video" autoplay playsinline></video>
            </div>
            
            <div class="call-controls">
                <button class="call-button mute" onclick="toggleMute()" id="muteButton">
                    <i class="fas fa-microphone"></i>
                </button>
                <button class="call-button camera" onclick="toggleCamera()" id="cameraButton">
                    <i class="fas fa-video"></i>
                </button>
                <button class="call-button end" onclick="endCall()">
                    <i class="fas fa-phone-slash"></i>
                </button>
                <button class="call-button speaker" onclick="toggleSpeaker()" id="speakerButton">
                    <i class="fas fa-volume-up"></i>
                </button>
            </div>
        </div>
    </div>

    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –ø–æ–∏—Å–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π -->
    <div class="modal-overlay hidden" id="userSearchModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title glow">üîç –ù–∞–π—Ç–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è</h2>
                <button class="modal-close" onclick="closeUserSearch()">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            
            <div class="modal-body">
                <div class="search-form">
                    <div class="form-group floating-label">
                        <input type="tel" id="searchPhone" class="cosmic-input" placeholder="+7 (900) 123-45-67">
                        <label for="searchPhone">üì± –ù–æ–º–µ—Ä —Ç–µ–ª–µ—Ñ–æ–Ω–∞ –¥–ª—è –ø–æ–∏—Å–∫–∞</label>
                        <div class="input-glow"></div>
                    </div>
                    
                    <button class="cosmic-button primary" id="searchUserBtn" onclick="searchUserByPhone()">
                        <span class="button-bg"></span>
                        <span class="button-text">üîç –ù–∞–π—Ç–∏</span>
                        <div class="button-particles"></div>
                    </button>
                </div>
                
                <div class="search-results hidden" id="searchResults">
                    <h3 class="results-title">–†–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø–æ–∏—Å–∫–∞:</h3>
                    <div class="user-result" id="userResult">
                        <div class="user-avatar">
                            <div class="avatar-glow"></div>
                            <span id="userInitials">–£–ü</span>
                        </div>
                        <div class="user-info">
                            <h4 id="userName">–ò–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è</h4>
                            <p id="userPhone">+7 (900) 123-45-67</p>
                        </div>
                        <div class="user-actions">
                            <button class="action-button message" onclick="createChatWithUser()" title="–ù–∞–ø–∏—Å–∞—Ç—å">
                                <i class="fas fa-comment"></i>
                            </button>
                            <button class="action-button call" onclick="callUser()" title="–ü–æ–∑–≤–æ–Ω–∏—Ç—å">
                                <i class="fas fa-video"></i>
                            </button>
                        </div>
                    </div>
                </div>
                
                <div class="search-empty hidden" id="searchEmpty">
                    <div class="empty-icon">üîç</div>
                    <h3>–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –Ω–∞–π–¥–µ–Ω</h3>
                    <p>–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø—Ä–∞–≤–∏–ª—å–Ω–æ—Å—Ç—å –Ω–æ–º–µ—Ä–∞ —Ç–µ–ª–µ—Ñ–æ–Ω–∞</p>
                </div>
            </div>
        </div>
    </div>

    <!-- –°–∫—Ä–∏–ø—Ç—ã -->
    <script src="animations.js"></script>
    <script src="auth.js"></script>
    <script src="chat.js"></script>
    <script src="videocall.js"></script>
    <script src="app.js"></script>
</body>
</html>